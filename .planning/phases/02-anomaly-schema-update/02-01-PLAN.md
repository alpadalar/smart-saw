---
phase: 02-anomaly-schema-update
plan: 01
type: execute
wave: 1
depends_on: []
files_modified: [src/services/database/schemas.py]
autonomous: true
---

<objective>
Add kafa_yuksekligi (head height) field to anomaly_events table schema.

Purpose: Record head height at time of anomaly detection for historical analysis - knowing where the saw head was when an anomaly occurred provides context for diagnosing cutting issues.
Output: Updated SCHEMA_ANOMALY_DB with kafa_yuksekligi column in anomaly_events table.
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/01-ml-schema-update/01-01-SUMMARY.md

@src/services/database/schemas.py
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add kafa_yuksekligi column to anomaly_events table</name>
  <files>src/services/database/schemas.py</files>
  <action>
Add `kafa_yuksekligi REAL` column to the `anomaly_events` table in `SCHEMA_ANOMALY_DB`.

Location: After `kesim_id INTEGER` line (line ~232), before the closing parenthesis.

The column stores head height in mm at the time of anomaly detection. Place it at the end of the column list (before kesim_id would also be acceptable, but after is cleaner since kesim_id is a reference while kafa_yuksekligi is measurement data).

Add a comment similar to ML schema: `-- Head height at anomaly detection (mm)`
  </action>
  <verify>grep -A 15 "CREATE TABLE IF NOT EXISTS anomaly_events" src/services/database/schemas.py | grep kafa_yuksekligi</verify>
  <done>kafa_yuksekligi REAL column present in anomaly_events table schema with comment</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `kafa_yuksekligi REAL` column exists in anomaly_events table definition
- [ ] Column has descriptive comment
- [ ] Python syntax valid: `python -c "import src.services.database.schemas"`
</verification>

<success_criteria>

- anomaly_events table schema includes kafa_yuksekligi column
- Schema follows existing code style (REAL type, comment format)
- No syntax errors in schemas.py
  </success_criteria>

<output>
After completion, create `.planning/phases/02-anomaly-schema-update/02-01-SUMMARY.md`
</output>
