---
phase: 14-chart-axis-sapma-gauge
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - src/gui/controllers/control_panel_controller.py
autonomous: true
---

<objective>
Add axis title labels to band deviation graph and fix Y-axis labels to always show a range that includes zero.

Purpose: Improve chart readability by adding axis context and ensuring deviation gauge always shows zero reference point in its labels.
Output: Band deviation graph with axis titles and Y-axis labels that reflect the full range including zero.
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

# Prior related work
@.planning/phases/06-dynamic-chart-axis-labels/06-01-SUMMARY.md

# Source files to modify
@src/gui/controllers/control_panel_controller.py
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add axis title labels to BandDeviationGraphWidget</name>
  <files>src/gui/controllers/control_panel_controller.py</files>
  <action>
Add Y-axis and X-axis title labels to BandDeviationGraphWidget following the same pattern established in CuttingGraphWidget (Phase 6):

1. In `__init__()` after creating the widget, add:
   - `self.y_axis_title` QLabel with text "Sapma (mm)" positioned left of the graph
   - `self.x_axis_title` QLabel with text "Zaman (s)" positioned below the graph

2. Use the same axis_title_style as CuttingGraphWidget:
   - Font: Plus Jakarta Sans, bold, 16px
   - Color: #F4F6FC
   - Background: transparent

3. In the bandDeviationFrame setup section (around line 840), after `self.band_deviation_graph.show()`, add:
   - Y-axis title label positioned to the left of the graph (around x=5 or using negative offset from graph)
   - X-axis title label positioned below the graph (around y=230 within bandDeviationFrame)

Note: The existing ustdegerlabel/altdegerlabel are at x=320, so Y-axis title should go to the left of the graph (x around 5-10).
  </action>
  <verify>Run application and visually confirm "Sapma (mm)" appears to the left of the deviation graph and "Zaman (s)" appears below it</verify>
  <done>Axis title labels visible on band deviation graph matching CuttingGraphWidget style</done>
</task>

<task type="auto">
  <name>Task 2: Fix Y-axis labels to always show range including zero</name>
  <files>src/gui/controllers/control_panel_controller.py</files>
  <action>
Modify the min/max label update logic so ustdegerlabel and altdegerlabel show the actual axis range (which includes 0) rather than just the data min/max:

1. In BandDeviationGraphWidget class, add two new methods:
   ```python
   def get_axis_max(self) -> float:
       """Return maximum value of axis range (includes 0)."""
       with self._data_lock:
           if not self.data_points:
               return 0.0
           values = [point[1] for point in self.data_points]
           return max(max(values), 0)  # Ensure 0 is included

   def get_axis_min(self) -> float:
       """Return minimum value of axis range (includes 0)."""
       with self._data_lock:
           if not self.data_points:
               return 0.0
           values = [point[1] for point in self.data_points]
           return min(min(values), 0)  # Ensure 0 is included
   ```

2. In ControlPanelController._update_sensor_display() around line 1947-1954, change:
   ```python
   max_value = self.band_deviation_graph.get_max_value()
   min_value = self.band_deviation_graph.get_min_value()
   ```
   To:
   ```python
   max_value = self.band_deviation_graph.get_axis_max()
   min_value = self.band_deviation_graph.get_axis_min()
   ```

This ensures the Y-axis labels always show a range that includes 0, matching what the graph actually displays.
  </action>
  <verify>Run application, observe deviation graph labels - when all values are positive, altdegerlabel should show "0.00"; when all values are negative, ustdegerlabel should show "0.00"</verify>
  <done>Y-axis labels always include zero in their range, matching the visual zero line position in the graph</done>
</task>

<task type="auto">
  <name>Task 3: Verify application runs without errors</name>
  <files>src/gui/controllers/control_panel_controller.py</files>
  <action>
1. Run grep to check for any syntax errors in modified code
2. Run Python syntax check on the modified file
3. Verify no import errors or missing dependencies
  </action>
  <verify>python3 -m py_compile src/gui/controllers/control_panel_controller.py</verify>
  <done>File compiles without syntax errors</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] python3 -m py_compile src/gui/controllers/control_panel_controller.py succeeds
- [ ] Y-axis title label "Sapma (mm)" visible on band deviation graph
- [ ] X-axis title label "Zaman (s)" visible below band deviation graph
- [ ] Y-axis labels (ustdegerlabel/altdegerlabel) show range including zero
</verification>

<success_criteria>

- All tasks completed
- All verification checks pass
- No errors or warnings introduced
- Band deviation graph has axis title labels matching CuttingGraphWidget style
- Y-axis labels always show a range that includes zero
</success_criteria>

<output>
After completion, create `.planning/phases/14-chart-axis-sapma-gauge/14-01-SUMMARY.md`
</output>
